# MCDCNFD 字体设计软件 - 用户手册 (v5.8)

欢迎使用 MCDCNFD 字体设计软件！本手册将引导您全面了解并熟练使用这款功能强大的手写字体设计工具。无论您是字体设计爱好者还是专业设计师，都能在这里找到创作的乐趣。

## 目录

1.  [软件简介](#1-软件简介)
2.  [快速入门](#2-快速入门)
    *   [安装依赖](#安装依赖)
    *   [界面概览](#界面概览)
3.  [核心概念](#3-核心概念)
    *   [笔画 (Stroke)](#笔画-stroke)
    *   [图层 (Layer)](#图层-layer)
    *   [部件 (Component)](#部件-component)
    *   [字符 (Character)](#字符-character)
4.  [基础工作流程](#4-基础工作流程)
    *   [第一步：创建或打开项目](#第一步创建或打开项目)
    *   [第二步：浏览与选择字符](#第二步浏览与选择字符)
    *   [第三步：开始绘制](#第三步开始绘制)
    *   [第四步：精细编辑](#第四步精细编辑)
    *   [第五步：预览与保存](#第五步预览与保存)
    *   [第六步：导出字体](#第六步导出字体)
5.  [功能详解：左侧面板](#5-功能详解左侧面板)
    *   [🔍 字符浏览器](#-字符浏览器)
    *   [🎨 设计面板](#-设计面板)
6.  [功能详解：右侧面板](#6-功能详解右侧面板)
    *   [👁️ 预览面板](#️-预览面板)
    *   [📊 分析面板](#-分析面板)
    *   [📝 属性面板](#-属性面板)
    *   [⚙️ 设置面板](#️-设置面板)
    *   [📤 导出面板](#-导出面板)
    *   [📜 历史面板](#-历史面板)
    *   [↔️ 字跨 (Kerning) 面板](#️-字跨-kerning-面板)
7.  [深度指南：节点编辑器](#7-深度指南节点编辑器)
    *   [选择节点与线段](#选择节点与线段)
    *   [移动与变形](#移动与变形)
    *   [节点类型转换](#节点类型转换)
    *   [路径操作](#路径操作)
    *   [上下文菜单（右键）](#上下文菜单右键)
8.  [文件管理](#8-文件管理)
9.  [常见问题 (FAQ)](#9-常见问题-faq)
10. [关于](#10-关于)

---

## 1. 软件简介

MCDCNFD 是一款专为手写字体和创意字体设计的矢量绘图软件。它提供了一套从手绘输入、矢量化、节点编辑到最终字体文件导出的完整工具链。

**核心特性：**

*   **直观的绘图体验**：提供毛笔、钢笔、铅笔等多种模拟笔刷。
*   **强大的节点编辑器**：对矢量路径进行像素级的精确控制。
*   **分层设计系统**：通过图层管理复杂的笔画结构。
*   **部件化与复用**：创建可复用的部件，提高设计效率。
*   **专业辅助线**：内置米字格、中宫、西文度量线等，辅助字形结构。
*   **实时预览**：即时查看单字和文本行的渲染效果。
*   **完整的撤销/重做**：所有操作均可撤销，放心创作。
*   **TTF 导出**：将您的设计成果导出为标准的 TrueType 字体文件。

## 2. 快速入门

### 安装依赖

为确保所有功能正常运行，请先安装必要的 Python 库：

```bash
pip install PyQt5 numpy
# 导出TTF字体所需
pip install fontTools
# 汉字拼音功能所需
pip install pypinyin
```

### 界面概览

软件主界面分为五个主要区域：

  <!-- 这是一个图片占位符 -->

1.  **顶部工具栏 (Toolbar)**：提供文件操作（新建、打开、保存）和字体导出功能。
2.  **左侧停靠面板 (Left Dock)**：包含**字符浏览器**和**设计面板**，是您查找字符和选择工具的主要区域。
3.  **中央工作区 (Central Workspace)**：核心的**绘图画布**，您将在这里完成所有设计工作。
4.  **右侧停靠面板 (Right Dock)**：包含预览、分析、属性、设置、导出、历史和字偶距管理等高级功能。
5.  **底部状态栏 (Status Bar)**：显示当前状态、项目信息和操作提示。

## 3. 核心概念

理解以下几个核心概念将帮助您更好地使用本软件。

### 笔画 (Stroke)

**笔画**是构成字符的最基本单位。它由一系列手绘的原始点数据和其矢量化后的贝塞尔曲线路径共同定义。

### 图层 (Layer)

在 MCDCNFD 中，每个笔画都存在于一个独立的**图层**上。这允许您：

*   **独立控制**：单独设置每个笔画的可见性、锁定状态和不透明度。
*   **调整堆叠顺序**：通过拖拽或按钮轻松调整笔画的前后关系。
*   **无损编辑**：对一个图层的操作不会影响其他图层。

### 部件 (Component)

**部件**是可被复用的设计单元，例如汉字中的“口”、“木”、“亻”等。您可以将一个设计好的字符或其一部分保存为部件，然后在其他字符设计中多次引用它。这极大地提升了设计一致性和效率。

### 字符 (Character)

**字符**是设计的最终载体。一个字符的设计由多个**图层（笔画）**和/或**部件实例**共同构成。

## 4. 基础工作流程

### 第一步：创建或打开项目

*   **新建项目**：点击工具栏的 `新建项目`。这将基于默认的字符数据库开始一个全新的设计项目。
*   **打开项目**：点击 `打开项目...`，选择一个之前保存的 `.mcdcnfd` 文件来继续您的工作。
*   **加载字库**：点击 `加载字库...`，您可以选择一个外部的 `.db` 文件作为项目的基础字符集。

### 第二步：浏览与选择字符

在左侧的**字符浏览器**中，您可以通过搜索、分类筛选等方式找到想要设计的字符，单击即可在中央画布中打开它。

### 第三步：开始绘制

在左侧**设计面板**的**工具**标签页中，选择一个绘图工具（如 `毛笔` 或 `钢笔`），调整好笔画宽度、颜色等参数，然后在中央画布上开始绘制。

### 第四步：精细编辑

绘制完成后，切换到 `节点编辑` 工具。您现在可以对笔画的贝塞尔曲线进行精细调整。详细操作请参见 [深度指南：节点编辑器](#7-深度指南节点编辑器)。

### 第五步：预览与保存

在右侧的**预览面板**中，您可以实时查看当前字符的放大预览和在文本行中的排版效果。满意后，随时按 `Ctrl+S` 或点击工具栏的 `保存项目` 来保存您的进度。

### 第六步：导出字体

当您完成足够多的字符设计后，可以前往右侧的**导出面板**，将您的作品导出为标准的 `.ttf` 字体文件。

## 5. 功能详解：左侧面板

### 🔍 字符浏览器

这是您导航整个字体项目的入口。

*   **搜索框**：快速搜索字符、拼音或部首。
*   **字符分类**：按类别（如汉字、字母、符号）筛选字符。
*   **高级过滤**：
    *   **笔画数**：筛选特定笔画数范围内的字符。
    *   **设计状态**：只显示“已设计”或“未设计”的字符。
*   **参考底模**：勾选后，会在画布背景中显示当前字符的系统标准字形，方便参考。
*   **字符列表**：以网格形式展示所有符合条件的字符。已设计的字符会以绿色高亮显示。

### 🎨 设计面板

这是集成了所有设计工具和操作的核心面板，它包含多个子标签页。

#### **工具 (Tools)**

*   **绘图工具**：
    *   `毛笔`、`钢笔`、`马克笔`、`铅笔`：模拟不同笔触的手绘工具。
    *   `橡皮擦`：(功能待实现)
    *   `节点编辑`：**核心编辑工具**，用于精细调整矢量路径。
    *   `直线`、`弧线`、`矩形`、`圆形`：快速创建基本几何形状。
*   **笔画参数**：
    *   `笔触宽度`：调整手绘工具的粗细。
    *   `平滑度`：控制手绘路径自动矢量化后的平滑程度。
    *   `笔画颜色`：选择笔画的颜色。
    *   `启用压感效果`：模拟笔速对笔画宽度的影响。
*   **显示选项**：
    *   `显示网格`：开关背景的 8x8 双层网格。
    *   `显示米字格/天地线`：开关传统的书法辅助线。
    *   `显示西文度量线`：开关 Ascender, Descender, x-Height 等西文排版基线。
    *   `显示专业中文辅助线`：开关**中宫框**和**视觉重心**标记，强烈推荐开启。
*   **编辑操作**：
    *   `撤销`/`重做`：管理操作历史。
    *   `清除`：删除当前字符的所有设计。
    *   `字形矢量化`：将系统字体中的字符轮廓自动转换为可编辑的笔画图层。
    *   (节点编辑专属) 其他按钮详见 [节点编辑器](#7-深度指南节点编辑器) 部分。

#### **图层 (Layers)**

管理当前字符的所有笔画图层。

*   **图层列表**：显示所有图层，最近绘制的在最上方。
    *   **可见性 (眼睛图标)**：点击切换图层是否可见。
    *   **锁定 (锁图标)**：点击切换图层是否可编辑。
    *   **重命名**：双击图层名称可进行重命名。
    *   **排序**：直接拖拽列表项可调整图层堆叠顺序。
*   **图层不透明度**：调整选中图层的不透明度。
*   **操作按钮**：新建、删除、上移、下移选中的图层。

#### **部件 (Components)**

管理可复用的设计部件。

*   **部件库**：显示项目中所有已保存的部件。
*   **预览区**：显示当前选中部件的预览图。
*   **操作按钮**：
    *   `保存当前设计为新部件`：将画布中的当前设计保存为一个新的可复用部件。
    *   `将选中部件插入当前字符`：将部件库中选中的部件作为一个整体插入到画布中。
    *   `删除选中部件`：从部件库中永久删除一个部件。

#### **AI助手 (AI Assistant)**

（此功能为实验性）提供基于文本描述的辅助设计能力。

## 6. 功能详解：右侧面板

### 👁️ 预览面板

实时查看您的设计效果。

*   **字符预览**：以大尺寸显示当前字符的最终渲染效果。
*   **文本预览**：输入任意文本，预览您的字体在实际排版中的效果。

### 📊 分析面板

提供项目和当前字符的数据统计。

*   **项目进度**：显示已设计字符数、总字符数及完成百分比。
*   **当前字符信息**：显示选中字符的 Unicode、笔画数、拼音、边界框尺寸等详细信息。

### 📝 属性面板

这是一个**上下文感知**的面板，其内容会根据您在画布上的选择动态变化。

*   **选中节点时**：显示节点的坐标、类型等信息。（未来可扩展）
*   **选中线段时**：显示线段的长度、角度，并允许调整曲线的**张力**。

### ⚙️ 设置面板

配置整个字体项目的全局元数据和度量信息。这些信息将直接影响最终导出的 TTF 字体文件。

*   **字体基础信息**：字体家族名、样式名、版本号、版权信息。
*   **核心字体度量 (Font Metrics)**：
    *   `UPM` (Units Per Em)：字体的内部网格精度，通常为 1024 或 2048。
    *   `Ascender` / `Descender`：上伸部 / 下伸部高度。
    *   `x-Height` / `Cap Height`：小写x高度 / 大写字母高度。

### 📤 导出面板

将您的作品导出为最终产品。

*   **TTF 字体导出**：
    *   `字体子集化`：勾选后，导出的字体文件将只包含您设计过的字符，大大减小文件体积。
    *   `导出为 .TTF 文件...`：启动字体编译和导出过程。
*   **图像导出 (当前字符)**：
    *   `导出为 .PNG`：将当前字符导出为带或不带透明背景的位图。
    *   `导出为 .SVG`：将当前字符导出为矢量图形文件。

### 📜 历史面板

可视化地展示您的每一步操作，您可以点击列表中的任意一项来回退或重做。

*   **操作历史记录**：显示所有可撤销的操作列表。
*   `清空历史记录`：清除所有撤销信息，释放内存（此操作不可撤销）。

### ↔️ 字跨 (Kerning) 面板

调整特定字符对之间的间距，提升阅读体验。

*   **实时预览**：直观地看到字偶距调整的实时效果。
*   **调整字符对**：
    *   输入框：输入要调整的字符对，如“你我”。
    *   调整值滑块：拖动以增减两个字符间的距离。
*   **已保存的字偶距对**：
    *   列表：显示所有已保存的字偶距对及其值。
    *   `保存/更新`：将当前调整保存到列表中。
    *   `删除`：删除列表中选中的字偶距对。

## 7. 深度指南：节点编辑器

节点编辑器是 MCDCNFD 的灵魂。切换到 `节点编辑` 工具后，画布上的笔画将显示其控制点和路径。

### 选择节点与线段

*   **选择笔画**：在笔画的路径上单击，即可选中整个笔画。
*   **选择单个节点**：在笔画的锚点（方形点）上单击。
*   **选择多个节点**：按住 `Shift` 键，然后逐个单击要选择的锚点。
*   **框选节点**：在画布的空白区域按住鼠标左键并拖动，可以画出一个选框，所有被框住的节点都将被选中。
*   **选择线段**：在两个锚点之间的路径上单击，可以选中该线段。

### 移动与变形

*   **移动节点**：拖动选中的锚点来改变其位置。如果选中多个，它们将一起移动。
*   **键盘微调 (Nudging)**：选中节点后，使用键盘**方向键**可以进行 1 个单位的微移。按住 `Shift` + 方向键则进行 10 个单位的移动。
*   **调整控制柄**：拖动锚点两端的圆形控制柄，可以改变曲线的形状和方向。
*   **平滑/非对称调整**：
    *   默认情况下，拖动“平滑”节点的控制柄，另一侧的控制柄会镜像移动。
    *   按住 `Alt` 键再拖动，可以只移动一侧的控制柄，从而创建非对称的尖角。该节点类型会自动转换为“非对称”。
*   **移动整个线段**：选中并拖动一条线段，可以平移该线段（对于曲线，会同时移动其两个控制柄）。

### 节点类型转换

选中一个或多个节点后，可以在**设计面板** > **工具** > **编辑操作**区点击按钮，或通过**右键菜单**来转换节点类型：

*   `转为尖角`：节点的两个控制柄可以完全独立移动。
*   `转为平滑`：节点的两个控制柄始终保持在一条直线上，且与锚点的距离相等。
*   `转为非对称`：两个控制柄保持在一条直线上，但与锚点的距离可以不同。

### 路径操作

*   `闭合路径`：如果一条路径是开放的，选中其**任一端点**后点击此按钮，软件会自动连接路径的首尾，形成一个封闭轮廓。
*   `断开路径`：如果一条路径是闭合的，选中**任意一个节点**后点击此按钮，路径将在此处被“剪开”，变为一条开放路径。
*   `插入节点`：点击此按钮进入插入模式（光标变为十字），然后在选中的笔画路径上单击，即可在点击位置添加一个新节点。
*   `删除节点`：删除所有选中的节点。软件会自动尝试平滑地连接被删除节点前后的路径。
*   `曲线转直线` / `直线转曲线`：转换选中节点**之后**的路径段的类型。

### 上下文菜单（右键）

在节点编辑模式下，右键单击画布会弹出上下文菜单，提供当前最相关的快捷操作：

*   **右键单击节点**：提供删除、转换类型、断开路径等操作。
*   **右键单击线段**：提供插入节点、转换线段类型等操作。
*   **右键单击空白区域**：提供全选/取消全选等操作。

## 8. 文件管理

*   **项目文件 (`.mcdcnfd`)**：这是软件的主要文件格式。它是一个 JSON 文件，包含了您所有的设计数据、笔画、部件、字体设置和字偶距信息。**请定期保存您的项目文件。**
*   **数据库文件 (`.db`)**：这是一个 SQLite 数据库，用于存储一个字体所需包含的**所有字符的元数据**（如拼音、部首等），但不包含您的设计。您可以加载不同的 `.db` 文件来开始针对不同字符集的项目（如 GB2312, BIG5 等）。

## 9. 常见问题 (FAQ)

1.  **为什么导出的 TTF 功能是灰色的？**
    *   您需要安装 `fontTools` 库。请在命令行运行 `pip install fonttools`。

2.  **为什么看不到汉字的拼音？**
    *   您需要安装 `pypinyin` 库。请在命令行运行 `pip install pypinyin`。

3.  **如何让笔画产生粗细变化？**
    *   在**设计面板** > **工具**中，勾选 `启用压感效果`。这会根据您的绘画速度模拟压力，速度越快，笔画越细。

4.  **修改了字体设置（如字体名）后需要做什么？**
    *   这些设置只在您**导出 TTF** 时才会生效。记得在修改后保存您的 `.mcdcnfd` 项目文件。

## 10. 关于

*   **原作者**：跳舞的火公子
*   **PyQt5 专业重构与注释**：MCD

感谢您使用 MCDCNFD，祝您创作愉快！
